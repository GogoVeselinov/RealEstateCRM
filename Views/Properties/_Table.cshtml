@model List<RealEstateCRM.Models.ViewModels.PropertyListItemViewModel>
@{
    var canEdit = (bool)(ViewBag.CanEdit ?? false);
}

<table class="table">
    <thead>
        <tr>
            <th>Заглавие</th>
            <th>Адрес</th>
            <th>Тип</th>
            <th>Статус</th>
            <th style="text-align:right;">Цена</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        @if (!Model.Any())
        {
            <tr>
                <td colspan="6" class="muted">Няма намерени имоти</td>
            </tr>
        }
        else
        {
            foreach (var p in Model)
            {
                <tr data-id="@p.Id">
                    <td>
                        <span class="cell view title">@p.Title</span>
                        <input class="cell edit title-input" style="display:none;width:100%" value="@p.Title" />
                    </td>
                    <td>
                        <span class="cell view address">@p.Address</span>
                        <input class="cell edit address-input" style="display:none;width:100%" value="@p.Address" />
                    </td>
                    <td>
                        <span class="cell view type">@p.Type</span>
                        <select class="cell edit type-select" style="display:none">
                            @foreach(var val in Enum.GetValues(typeof(RealEstateCRM.Models.Common.PropertyType)).Cast<RealEstateCRM.Models.Common.PropertyType>())
                            {
                                <option value="@((int)val)" selected="@(val == p.Type ? "selected" : null)">@val</option>
                            }
                        </select>
                    </td>
                    <td>
                        <span class="cell view status">@p.Status</span>
                        <select class="cell edit status-select" style="display:none">
                            @foreach(var val in Enum.GetValues(typeof(RealEstateCRM.Models.Common.ListingStatus)).Cast<RealEstateCRM.Models.Common.ListingStatus>())
                            {
                                <option value="@((int)val)" selected="@(val == p.Status ? "selected" : null)">@val</option>
                            }
                        </select>
                    </td>
                    <td style="text-align:right;">
                        <span class="cell view price">@p.Price</span>
                        <input class="cell edit price-input" style="display:none;width:120px;text-align:right" value="@p.Price" />
                        <span class="cell view currency">@p.Currency</span>
                        <input class="cell edit currency-input" style="display:none;width:70px;margin-left:6px" value="@p.Currency" />
                    </td>
                    <td style="text-align:right; white-space:nowrap;">
                        @if (canEdit)
                        {
                            <button class="btn secondary btn-enter-edit">Редактирай</button>
                            <button class="btn secondary btn-save-row" style="display:none">Запази</button>
                            <button class="btn secondary btn-cancel-edit" style="display:none">Откажи</button>
                            <button class="btn btn-delete" data-id="@p.Id">Изтрий</button>
                        }
                    </td>
                </tr>
            }
        }
    </tbody>
</table>
